@model List<HjuletRestaurang.Models.Dish>

@{
    ViewBag.Title = "Home Page";
}

@foreach (var dish in Model)
{
    <input class="checkbox" type="checkbox" value=@dish.Id />
    <p>@dish.Name</p>
    <p>@dish.Price</p>
}
@*<input id ="checkbox" type="checkbox" value=@Guid.NewGuid()/>*@
<button id="submit" class="btn btn-default">Beställ</button>


@section scripts{
    <script src="~/signalr/js"></script>
    <script>

        $(function () {
            // Reference the auto-generated proxy for the hub.
            var restaurant = $.connection.restaurantHub;
            $('#submit').click(function () {
                var checkedBoxesVal = "";

                var checkboxes = $(".checkbox");
                for (var i = 0; i < checkboxes.length; i++) {
                    if (checkboxes[i].checked) {
                        checkedBoxesVal = checkedBoxesVal.concat(checkboxes[i].value);
                        if (i !== checkboxes.length - 1) {
                            checkedBoxesVal = checkedBoxesVal.concat(",");
                        }
                    }
                }
                console.log(checkedBoxesVal);


                restaurant.server.sendOrder(checkedBoxesVal);
            });
            $.connection.hub.start().done(function () {
                console.log("Done!");
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>

}
